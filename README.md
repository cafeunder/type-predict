# type-predict

## このリポジトリについて
深層学習によってポケモンのタイプ推定を行うコードを公開しています．

ポケモンの画像データを用いてタイプを推定するように学習させたモデルを用いて，ポケモン以外の画像のタイプ推定を行うことができます．

## 実行
### 学習済みモデルを用いた画像のタイプ推定実行
本リポジトリには学習済みモデルのデータを含んでいるため，リポジトリをダウンロードすることですぐに画像のタイプ推定を実行することができます．

学習済みモデルを用いるために，まず，以下のコマンドを実行して分割されたモデルデータを復元します．
```
cd src
python revert_model.py
```

次に，任意のフォルダを作成し，そのフォルダ内にタイプ推定を行いたい画像を入れてください．

最後に，以下のコマンドを実行することでタイプ推定を行うことができます．
```
python test.py --img <追加した画像へのパス>
```

実行を行うと，以下のような結果が出力されます．
```
Image name is : <追加した画像へのパス>
Type1 of this image is : water
Type2 of this image is : none
```
ポケモンはタイプを最大で２つまで持つことができるため，この実装でも２つのタイプを推定します．
`Type2 of this image is : none`となっている場合，２つ目のタイプは存在せず，その画像は１つのタイプしか持たない，ということを表しています．

実行時にGPUを用いて推定を行わせたい場合，`--gpu 0`のようにしてGPUのデバイスをオプションで指定して実行してください．

また，指定したフォルダ直下にある全ての画像に対してまとめてタイプ推定を行わせたい場合，以下のように`--all`オプションを指定してください．
```
python test.py --img <画像を置いたフォルダへのパス> --all
```
